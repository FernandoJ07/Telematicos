<VirtualHost *:80>
    ServerName localhost
    ServerAdmin webmaster@localhost
    
    # Server Status para métricas (permitir acceso sin HTTPS)
    <Location /server-status>
        SetHandler server-status
        Require local
        Require ip 172.16.0.0/12
    </Location>
    
    # Redirección automática a HTTPS (excepto /server-status)
    RewriteEngine On
    RewriteCond %{REQUEST_URI} !^/server-status
    RewriteCond %{HTTPS} off
    RewriteRule ^(.*)$ https://localhost:8443$1 [L,R=301]
    
    ErrorLog ${APACHE_LOG_DIR}/webapp_error.log
    CustomLog ${APACHE_LOG_DIR}/webapp_access.log combined
</VirtualHost>
